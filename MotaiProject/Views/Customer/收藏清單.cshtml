@model IEnumerable<MotaiProject.ViewModels.FavoriteViewModel>

@{
    ViewBag.Title = "收藏清單";
    Layout = "~/Views/Shared/_Layout登入.cshtml";
}

<style>
    .cardrow {
        height : 400px;
        width:300px;
        padding : 10px;
        margin : 10px;
    }
    .cardimg{
        width:100%;
        height:50%;
    }
    .wrapper {
        position: relative;
        width: 960px;
        height: 300px;
        overflow: hidden;
        margin: 100px auto;
    }


    ul.slides {
        width: 2200px;
        left: 0px;
        transition: all 1s;
        margin: 0;
        padding: 0;
        position: absolute;
    }

        ul.slides li {
            margin: 20px;
            padding: 0;
            list-style: none;
            width: 200px;
            height: 300px;
            overflow: hidden;
            float: left;
        }

            ul.slides li img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

    .dot {
        bottom: 10px;
        width: 100%;
        display: flex;
        justify-content: center;
    }

        .dot li {
            border: 1px solid #fff;
            /* border-radius: 50%; */
            margin: 0 5px;
            width: 24px;
            height: 10px;
        }

    /* .dot li:hover{
            background: #fff;
        } */
    .slide_btn {
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        bottom: 0;
        width: 30px;
        color: #fff;
        position: absolute;
        font-size: 24px;
    }

    #prevSlide {
        left: 0;
    }

    #nextSlide {
        right: 0;
    }

    .slide_btn i {
        color: rgba(255, 255, 255, .6);
        transition: .5s;
    }

    .slide_btn:hover i {
        color: rgba(255, 255, 255, 1);
    }
</style>

<content>
    <script type="text/javascript">
        function collect(id) {
           
            //var card1 = document.createElement("div");
            //card1.className = "card col-xl-4 col-md-6";//class
            //card1.style.height = "400px";
            //card1.style.padding = "10px";
            //card1.style.margin = "10px";
            //card1.id = "card" + id;
            //document.getElementById(`productrow`).appendChild(card1);
            //let img1 = document.createElement("img");
            //img1.src = "https://img.ruten.com.tw/s1/5/6d/55/21506424980821_486.jpg";//產品圖片
            //img1.className = "card-img-top";
            //img1.style.width = "90%";
            //img1.style.height = "60%";
            //document.getElementById(`card${id2}`).appendChild(img1);
            //let cardbody1 = document.createElement("div");
            //cardbody1.className = "card-body d-block"
            //cardbody1.style.height = "120px";
            //cardbody1.id = "cardbody" + id;
            //document.getElementById(`card${id2}`).appendChild(cardbody1);
            //let titel1 = document.createElement("h5");
            //titel1.className = "card-title d-flex"
            //titel1.style.width = "70%";
            //titel1.innerHTML = name;//商品名
            //document.getElementById(`cardbody${id}`).appendChild(titel1);
            //let cardtext1 = document.createElement("p");
            //cardtext1.className = "card-text d-block"
            //cardtext1.style.height = "20px";
            //cardtext1.innerHTML = price;//商品價格
            //document.getElementById(`cardbody${id}`).appendChild(cardtext1);
            //$(`#cardbody${ id }`).append(`<svg id="starlight${id}" height="32px" width="50px" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="star" class="svg-inline--fa fa-star fa-w-18" role="img" viewBox="0 0 576 512"><path fill="#F2EDD8" d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z" /></svg>`);
            let star1 = document.getElementById(`starlight${id}`);
            star1.setAttribute("onclick", `cancelFavor(${id})`);
            //$(`#cardbody${id}`).append(`<svg id="star${id}" height="32px" width="50px" aria-hidden="true" focusable="false" data-prefix="far" data-icon="star" class="svg-inline--fa fa-star fa-w-18" role="img" viewBox="0 0 576 512"><path fill="#F2EDD8" d="M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z" /></svg>`);
            let star2 = document.getElementById(`star${id}`);
            //star2.style.display = "none";
            star2.setAttribute("onclick", `addFavor(${id})`);
            //document.getElementById(`cardbody${id}`).appendChild(star1);
            document.querySelector(`#img${id}`).setAttribute("onclick", `javascript:location.href='@Url.Action("產品細節", "Customer")?ProductId=${id}'`);//插入url
            //$(`#cardbody${id}`).append(`<svg id="cart${id}" height="30px" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="cart-plus" class="d-flex svg-inline--fa fa-cart-plus fa-w-18" role="img" viewBox="0 0 576 512"><path fill="#A22E37" d="M504.717 320H211.572l6.545 32h268.418c15.401 0 26.816 14.301 23.403 29.319l-5.517 24.276C523.112 414.668 536 433.828 536 456c0 31.202-25.519 56.444-56.824 55.994-29.823-.429-54.35-24.631-55.155-54.447-.44-16.287 6.085-31.049 16.803-41.548H231.176C241.553 426.165 248 440.326 248 456c0 31.813-26.528 57.431-58.67 55.938-28.54-1.325-51.751-24.385-53.251-52.917-1.158-22.034 10.436-41.455 28.051-51.586L93.883 64H24C10.745 64 0 53.255 0 40V24C0 10.745 10.745 0 24 0h102.529c11.401 0 21.228 8.021 23.513 19.19L159.208 64H551.99c15.401 0 26.816 14.301 23.403 29.319l-47.273 208C525.637 312.246 515.923 320 504.717 320zM408 168h-48v-40c0-8.837-7.163-16-16-16h-16c-8.837 0-16 7.163-16 16v40h-48c-8.837 0-16 7.163-16 16v16c0 8.837 7.163 16 16 16h48v40c0 8.837 7.163 16 16 16h16c8.837 0 16-7.163 16-16v-40h48c8.837 0 16-7.163 16-16v-16c0-8.837-7.163-16-16-16z" /></svg>`);
            let cart = document.getElementById(`cart${id}`);
            cart.style.marginLeft = "50%";
            cart.style.marginTop = "-30px";
            cart.setAttribute("onclick", `addTocart(${id})`);
        }
    </script>
    <div class="container">


        <div class="container row">

                @if (Model != null)
                {
                    foreach (var item in Model)
                    {
                        <div id="card@(item.fProductId)" class="card  cardrow">
                            <img id="img@(item.fProductId)" src = "https://img.ruten.com.tw/s1/5/6d/55/21506424980821_486.jpg" class="card-img-top cardimg"/>@*產品圖*@
                            <div id="cardbody@(item.fProductId)" class="card-body d-block">
                                <h5 class="card-title d-flex">@item.pName</h5>
                                <p class="card-text d-block">@item.pPrice</p>
                                <svg id="starlight@(item.fProductId)" height="32px" width="50px" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="star" class="svg-inline--fa fa-star fa-w-18" role="img" viewBox="0 0 576 512"><path fill="#F2EDD8" d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z" /></svg>
                                <svg id="star@(item.fProductId)" style="display:none" height="32px" width="50px" aria-hidden="true" focusable="false" data-prefix="far" data-icon="star" class="svg-inline--fa fa-star fa-w-18" role="img" viewBox="0 0 576 512"><path fill="#F2EDD8" d="M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z" /></svg>
                                <svg id="cart@(item.fProductId)" height="30px" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="cart-plus" class="d-flex svg-inline--fa fa-cart-plus fa-w-18" role="img" viewBox="0 0 576 512"><path fill="#A22E37" d="M504.717 320H211.572l6.545 32h268.418c15.401 0 26.816 14.301 23.403 29.319l-5.517 24.276C523.112 414.668 536 433.828 536 456c0 31.202-25.519 56.444-56.824 55.994-29.823-.429-54.35-24.631-55.155-54.447-.44-16.287 6.085-31.049 16.803-41.548H231.176C241.553 426.165 248 440.326 248 456c0 31.813-26.528 57.431-58.67 55.938-28.54-1.325-51.751-24.385-53.251-52.917-1.158-22.034 10.436-41.455 28.051-51.586L93.883 64H24C10.745 64 0 53.255 0 40V24C0 10.745 10.745 0 24 0h102.529c11.401 0 21.228 8.021 23.513 19.19L159.208 64H551.99c15.401 0 26.816 14.301 23.403 29.319l-47.273 208C525.637 312.246 515.923 320 504.717 320zM408 168h-48v-40c0-8.837-7.163-16-16-16h-16c-8.837 0-16 7.163-16 16v40h-48c-8.837 0-16 7.163-16 16v16c0 8.837 7.163 16 16 16h48v40c0 8.837 7.163 16 16 16h16c8.837 0 16-7.163 16-16v-40h48c8.837 0 16-7.163 16-16v-16c0-8.837-7.163-16-16-16z" /></svg>
                            </div>
                     <script>
                      window.onload = collect(@item.fProductId);
                            </script>
                        </div>
                    }
                }

        </div>
        @*<div class="container-fluid" style="height:200px">
            <button class="btn btn-primary" onclick="favororder()">測試</button>
        </div>*@


    </div>
    <div class="container" @*style="overflow:hidden" *@>
        <div class="row">
            <div class="container">
                <div class="row">
                    <div class="wrapper">
                        <ul class="slides">
                            @*<li>
                                <img id="img1" src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img id="img2" src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img id="img3" src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>
                            <li>
                                <img src="https://cdn.pixabay.com/photo/2020/08/14/14/49/women-5488183_1280.jpg"
                                     alt="">
                            </li>*@
                            @for (int i = 1; i < 11; i++)
                            {
                                <li>
                                    <img id="orderimg@(i)" src=""
                                         alt="">
                                </li>
                            }
                        </ul>
                        <div id="prevSlide" class="slide_btn">
                            <i class="carousel-control-prev-icon"></i>
                        </div>
                        <div id="nextSlide" class="slide_btn">
                            <i class="carousel-control-next-icon"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function cancelFavor(productid) {
            fetch('/Customer/CancelFavorite', {
                method: 'POST',
                headers: {
                    "Content-type": "application/x-www-form-urlencoded; charset=UTF-8"
                },
                body: `ProductId=${productid}`
            }).then(function (response) {
                return response.json();
            }).then(function (data) {
                if (data.result) {
                    $(`#starlight${productid}`).css("display", "none");
                    $(`#star${productid}`).css("display", "block");
                }
            });
        }
        function addFavor(productid) {
            fetch('/Customer/AddFavorite', {
                method: 'POST',
                headers: {
                    "Content-type": "application/x-www-form-urlencoded; charset=UTF-8"
                },
                body: `ProductId=${productid}`
            }).then(function (response) {
                return response.json();
            }).then(function (data) {
                if (data.result) {
                    $(`#star${productid}`).css("display", "none");
                    $(`#starlight${productid}`).css("display", "block");
                }
            });
        }
    </script>
    <script>
        function addTocart(productid) {
            fetch('/Customer/AddToCart', {
                method: 'POST',
                headers: {
                    "Content-type": "application/x-www-form-urlencoded; charset=UTF-8"
                },
                body: `ProductId=${productid}&buyQty=1`
            }).then(function (response) {
                return response.json();
            })
                .then(function (data) {
                    alert(data.msg);

                })
        }
    </script>
    <script type="text/javascript">
        (function favororder() {
            fetch('/Customer/收藏排名', {
            method: 'POST',
            headers: {
                "Content-type": "application/x-www-form-urlencoded; charset=UTF-8"
            },
        }).then(function (response) {
            return response.json();
                }).then(function (data) {
                    //console.log((try { } catch{ }) ? "yes" : "arg");
                    //console.log(data.favorOrderby[0]["Pid"])
                    for (let i = 1; i < 11; i++) {
                        let xx = $(`#orderimg${i}`);
                        xx.attr("src", "https://sites.google.com/a/netcmmi.com/share/_/rsrc/1473734124982/img/png/s/star-e01.png");
                        let S = data.favorOrderby[i-1]["Pid"];
                        xx.attr("onclick", `javascript:location.href='@Url.Action("產品細節", "Customer")?ProductId=${S}'`)
                    }
                    
        });
        })()       
    </script>



    <script>
        $(function () {

            let slideNum = 0;
            let slideCount = $(".slides li").length;
            let lastIndex = slideCount - 5;


            // let play = window.setInterval(setPlay, 1500);
            function setPlay() {
                show();
                slideNum++
                if (slideNum > lastIndex) {
                    slideNum = 0;
                }
            }

            function stopPlay() {
                clearInterval(play);
            }

            function show() {
                let move = 0 - 240 * slideNum;
                $(".dot li").eq(slideNum).css("background-color", "#fff").siblings().css("background-color", "transparent");
                $("ul.slides").css("left", move);
            }

            // $(".wrapper").hover(function () {
            //     stopPlay();
            //     console.log("stop");
            // }, function () {
            //     play = window.setInterval(setPlay, 500);
            //     console.log("play");
            // });

            $(".dot li").eq(0).css("background-color", "#fff").siblings().css("background-color", "transparent");
            $(".dot li").mouseenter(function () {
                slideNum = $(this).index();
                show();
            });

            $("#prevSlide").click(function () {
                slideNum--;
                if (slideNum < 0) {
                    slideNum = lastIndex;
                }
                show();
            })

            $("#nextSlide").click(function () {
                slideNum++;
                if (slideNum > lastIndex) {
                    slideNum = 0;
                }
                show();
            })

        });
    </script>
</content>

